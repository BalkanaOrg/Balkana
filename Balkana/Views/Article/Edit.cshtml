@model Balkana.Models.Article.ArticleFormModel

@{
    ViewData["Title"] = "Edit Article";
}

<div class="article-form-page">
    <div class="article-form-container">
        <div class="article-form-header">
            <h1 class="article-form-title">Edit Article</h1>
            <p class="article-form-subtitle">Update your article content and details</p>
        </div>

        <form asp-action="Edit" method="post" enctype="multipart/form-data" class="article-form">
            <input type="hidden" asp-for="ThumbnailUrl" />

            <div class="form-group-modern">
                <label asp-for="Title" class="form-label-modern">
                    <i class="fi fi-rr-heading"></i>
                    Article Title
                </label>
                <input asp-for="Title" class="form-input-modern" placeholder="Enter a compelling title..." />
                <span asp-validation-for="Title" class="form-error"></span>
            </div>

            <div class="form-group-modern">
                <label asp-for="File" class="form-label-modern">
                    <i class="fi fi-rr-picture"></i>
                    Thumbnail Image
                </label>
                @if (!string.IsNullOrEmpty(Model.ThumbnailUrl))
                {
                    <div class="current-thumbnail">
                        <img src="@Model.ThumbnailUrl" alt="Current thumbnail" />
                        <span>Current thumbnail</span>
                    </div>
                }
                <div class="file-upload-wrapper">
                    <input asp-for="File" type="file" class="form-file-modern" accept="image/*" />
                    <div class="file-upload-label">
                        <i class="fi fi-rr-upload"></i>
                        <span>Choose a new image or drag it here</span>
                    </div>
                </div>
            </div>

            <div class="form-group-modern">
                <label asp-for="Content" class="form-label-modern">
                    <i class="fi fi-rr-document"></i>
                    Article Content
                </label>
                <div class="editor-wrapper">
                    <textarea asp-for="Content" id="editor" class="form-textarea-modern">@Model.Content</textarea>
                </div>
                <span asp-validation-for="Content" class="form-error"></span>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-modern btn-modern-primary">
                    <i class="fi fi-rr-check"></i>
                    Update Article
                </button>
                <a asp-action="Index" class="btn-modern btn-modern-secondary">
                    <i class="fi fi-rr-cross"></i>
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.ckeditor.com/ckeditor5/41.3.1/super-build/ckeditor.js"></script>
    <script>
        CKEDITOR.ClassicEditor
            .create(document.querySelector('#editor'), {
                simpleUpload: {
                    uploadUrl: '/file/upload'
                },
                toolbar: [
                    'heading', '|',
                    'bold', 'italic', 'link', '|',
                    'bulletedList', 'numberedList', '|',
                    'blockQuote', 'undo', 'redo', '|',
                    'uploadImage', 'mediaEmbed'
                ],
                removePlugins: [
                    // Collaboration (already removed)
                    'RealTimeCollaborativeComments',
                    'RealTimeCollaborativeTrackChanges',
                    'RealTimeCollaborativeRevisionHistory',
                    'PresenceList',
                    'Comments',
                    'TrackChanges',
                    'TrackChangesData',
                    'RevisionHistory',

                    // Premium plugins throwing license errors
                    'MultiLevelList',
                    'TableOfContents',
                    'FormatPainter',
                    'PasteFromOfficeEnhanced',

                    // Other non-essential
                    'Pagination',
                    'WProofreader',
                    'MathType',
                    'CaseChange',
                    'SlashCommand',
                    'Template',
                    'DocumentOutline',
                    'AIAssistant'
                ]
            })
            .then(editor => console.log('Editor ready ✅', editor))
            .catch(error => console.error('Editor init error ❌:', error));
    </script>
}
